<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <!-- Copyright (c) 2021, Morgan Hofmann - All rights to this concept are reserved. -->

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>leafal.io</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="nav-bar">
      <div class="nav-bar-items">
        <a class="nav-bar-item" href="./index.html"><img src="https://www.leafal.io/assets/img/brand/logo-spacing.png"></a>
        <a class="nav-bar-item" href="./index.html">Home</a>
        <a class="nav-bar-item" href="./community.html">Community</a>
        <a class="nav-bar-item" href="./events.html">Events</a>
      </div>
    </div>

    <div class="container">
      <div id="storefront">
        <div class="main-wrapper">
          <div class="storefront-featured">
            <div class="slides" id="slides-container">

            </div>
            <div class="slide-selector" id="slide-select-container">
            </div>
          </div>
        </div>

        <script type="text/javascript">
          var slideIndex = -1;
          var slideInterval;

          var slideTemplate = `
            <div class="slide">
              <div class="background">
                <div class="image" style="background-color:%color%;"></div>
              </div>
              <div class="overlay">

              </div>
            </div>
          `;

          var slideSelectTemplate = `
            <div class="slide-select" data-index="%i%">
              <div class="background">
                <div class="image" style="background-color:%color%;"></div>
              </div>
              <div class="overlay">

              </div>
            </div>
          `;

          var slides = [
            { color: "#c00" },
            { color: "#0c0" },
            { color: "#00c" },
            { color: "#cc0" },
            { color: "#c0c" },
          ];

          function injectSlides() {
            slides.forEach((item, i) => {
              const t = document.createElement('template');
              var temp = slideTemplate.replace(/%color%/g, item.color);
              t.innerHTML = temp;

              document.getElementById("slides-container").appendChild(t.content.cloneNode(true));

              const t2 = document.createElement('template');
              var temp2 = slideSelectTemplate.replace(/%color%/g, item.color).replace(/%i%/g, i);
              t2.innerHTML = temp2;

              document.getElementById("slide-select-container").appendChild(t2.content.cloneNode(true));
            });
          }

          function featuredNextSlide() {
            var slides = document.querySelectorAll("#storefront .storefront-featured .slide");

            slideIndex++;
            if (slideIndex > slides.length - 1) slideIndex = 0;

            slides.forEach((element) => {
              element.classList.remove("active");
            });

            document.querySelectorAll("#storefront .storefront-featured .slide-select").forEach((element) => {
              element.classList.remove("active");
            });

            var selector = document.querySelector(`#storefront .storefront-featured .slide-select[data-index="${slideIndex}"]`);

            slides[slideIndex].classList.add("active");
            selector.classList.add("active");
          }

          function prepareSlides() {
            slideInterval = setInterval(() => { featuredNextSlide(); }, 5000);
            featuredNextSlide();

            document.querySelectorAll(`#storefront .storefront-featured .slide-select[data-index]`).forEach((obj) => {
              obj.addEventListener("click", () => {
                if (slideIndex == obj.getAttribute("data-index")) return;

                slideIndex = obj.getAttribute("data-index") - 1;

                clearInterval(slideInterval);
                slideInterval = setInterval(() => { featuredNextSlide(); }, 5000);

                featuredNextSlide();
              });
            });
          }

          window.onload = () => {
            prepareSlides();
          };

          injectSlides();
        </script>
      </div>
    </div>
  </body>
</html>
